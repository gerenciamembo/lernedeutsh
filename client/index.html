<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenador de Mazos</title>
    <script>
        (function () {
            const storageKey = 'theme-preference';
            let theme = 'dark';
            try {
                const stored = localStorage.getItem(storageKey);
                if (stored) {
                    theme = stored;
                } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    theme = 'dark';
                } else {
                    theme = 'light';
                }
            } catch (error) {
                theme = 'dark';
            }
            document.documentElement.dataset.theme = theme;
        }());
    </script>
    <script>
        (function () {
            const storageKey = 'language-preference';
            try {
                const stored = localStorage.getItem(storageKey);
                if (stored === 'es' || stored === 'en') {
                    document.documentElement.lang = stored;
                }
            } catch (error) {
                document.documentElement.lang = 'es';
            }
        }());
    </script>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="layout">
        <header class="top-bar">
            <div class="brand">
                <span class="brand-icon">üÉè</span>
                <div>
                    <h1 data-i18n="app.title">Entrenador de Mazos</h1>
                    <p data-i18n="app.tagline">Organiza tus tarjetas y rep√°salas con un flujo inteligente</p>
                </div>
            </div>
            <div class="top-bar-actions">
                <button class="ghost" type="button" id="language-toggle" aria-label="Cambiar idioma" title="Cambiar idioma">üá™üá∏</button>
                <button class="ghost" type="button" id="theme-toggle" aria-label="Cambiar tema" title="Cambiar tema">Modo oscuro</button>
                <button class="primary" id="open-deck-form" data-i18n="actions.addDeck">Agregar mazo</button>
            </div>
        </header>

        <main class="content">
            <section id="deck-list-view" class="panel active">
                <div class="panel-header">
                    <h2 data-i18n="deck.listTitle">Tus mazos</h2>
                    <p data-i18n="deck.uploadHint">Sube un archivo JSON o Excel (.xlsx) donde cada fila represente una tarjeta con pares clave/valor.</p>
                </div>
                <div id="deck-empty" class="empty-state hidden">
                    <div class="empty-icon">üìÇ</div>
                    <h3 data-i18n="deck.emptyTitle">No hay mazos todav√≠a</h3>
                    <p data-i18n="deck.emptyDescription">Comienza creando uno nuevo con el bot√≥n ‚ÄúAgregar mazo‚Äù.</p>
                </div>
                <div id="deck-grid" class="deck-grid"></div>
            </section>

            <section id="deck-session-view" class="panel">
                <div class="session-header">
                    <button class="ghost" id="exit-session" data-i18n="session.exit">‚Üê Volver</button>
                    <div class="session-info">
                        <h2 id="session-title">Mazo</h2>
                        <p id="session-subtitle"></p>
                    </div>
                </div>
                <div id="session-body" class="session-body">
                    <div class="card" id="card-view">
                        <div class="card-meta">
                            <span id="card-step"></span>
                            <span id="card-score"></span>
                        </div>
                        <div id="card-content" class="card-content"></div>
                    </div>
                    <div class="session-actions">
                    <button class="danger" id="mark-incorrect" data-i18n="session.markIncorrect">‚úï No entend√≠</button>
                    <button class="success" id="mark-correct" data-i18n="session.markCorrect">‚úì Comprendido</button>
                    </div>
                    <div id="session-message" class="session-message hidden"></div>
                </div>
            </section>
        </main>
    </div>

    <div id="deck-form-overlay" class="overlay hidden" role="dialog" aria-modal="true">
        <div class="overlay-content">
            <div class="overlay-header">
                <h2 data-i18n="deckForm.title">Nuevo mazo</h2>
                <button id="close-deck-form" class="ghost" aria-label="Cerrar" data-i18n-attr-aria-label="deckForm.close">‚úï</button>
            </div>
            <form id="deck-form" class="form">
                <label class="form-field">
                    <span data-i18n="deckForm.nameLabel">Nombre del mazo</span>
                    <input type="text" name="name" placeholder="Ej. Vocabulario b√°sico" required data-i18n-attr-placeholder="deckForm.namePlaceholder">
                </label>
                <label class="form-field">
                    <span data-i18n="deckForm.fileLabel">Archivo de tarjetas (JSON o Excel)</span>
                    <input type="file" name="file" accept="application/json,.json,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.xlsx" required>
                    <small data-i18n="deckForm.fileHelp">Sube un archivo JSON con un arreglo de objetos o un Excel (.xlsx) con encabezados en la primera fila.</small>
                </label>
                <div class="form-actions">
                    <button type="button" class="ghost" id="cancel-deck-form" data-i18n="deckForm.cancel">Cancelar</button>
                    <button type="submit" class="primary" data-i18n="deckForm.submit">Guardar mazo</button>
                </div>
                <p class="form-feedback" id="deck-form-feedback"></p>
            </form>
        </div>
    </div>

    <script src="main.js" type="module"></script>
</body>
</html>
